#!/bin/sh

WORKSPACE=${WORKSPACE:-$PWD}

export CI_BUILD_ID=${GITHUB_RUN_ID:-$CI_BUILD_ID}
export CI_BUILD_NUMBER=${GITHUB_RUN_NUMBER:-$CI_BUILD_NUMBER}
export EVENT_PATH=${GITHUB_EVENT_PATH:-$EVENT_PATH}
export COMMIT_HASH=${GITHUB_SHA:-$COMMIT_HASH}
export COMMIT_REF_NAME=${GITHUB_REF_NAME:-$COMMIT_REF_NAME}
export REPOSITORY=${GITHUB_REPOSITORY:-$REPOSITORY}

echo Environment:
[ -z ${WORKSPACE} ] || echo "WORKSPACE=$WORKSPACE"
[ -z ${CI_BUILD_ID} ] || echo "CI_BUILD_ID=$CI_BUILD_ID"
[ -z ${CI_BUILD_NUMBER} ] || echo "CI_BUILD_NUMBER=$CI_BUILD_NUMBER"
[ -z ${EVENT_PATH} ] || echo "EVENT_PATH=$EVENT_PATH"
[ -z ${COMMIT_HASH} ] || echo "COMMIT_HASH=$COMMIT_HASH"
[ -z ${COMMIT_REF_NAME} ] || echo "COMMIT_REF_NAME=$COMMIT_REF_NAME"
[ -z ${REPOSITORY} ] || echo "REPOSITORY=$REPOSITORY"
echo

cd $WORKSPACE

TS_NODE_COMPILER_OPTIONS='{"module":"commonjs"}' lost-pixel $@
